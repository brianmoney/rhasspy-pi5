services:
  rhasspy:
    image: rhasspy/rhasspy
    container_name: rhasspy
    restart: unless-stopped
    network_mode: host  # Required for MQTT or UDP-based mic integrations
    devices:
      - "/dev/snd:/dev/snd"
    environment:
      - PULSE_SERVER=unix:/run/user/1000/pulse/native
      - ALSA_CARD=1
      - RHASSPY_MQTT_HOST=mosquitto
    volumes:
      - /run/user/1000/pulse:/run/user/1000/pulse
      - ./profiles:/profiles
    user: "1000:1000"
    tty: true
    depends_on:
      - mosquitto
    command: --user-profiles /profiles --profile en



  mosquitto:
    image: eclipse-mosquitto
    container_name: mosquitto
    restart: unless-stopped
    ports:
      - "1883:1883"
