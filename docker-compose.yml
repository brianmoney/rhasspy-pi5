services:
  mosquitto:
    image: eclipse-mosquitto:2
    container_name: mosquitto
    restart: unless-stopped
    ports:
      - "1883:1883"         # MQTT for anything on your LAN
    volumes:                # keep persistence, no custom conf needed
      - mosquitto_data:/mosquitto/data
      - mosquitto_log:/mosquitto/log

  rhasspy:
    image: rhasspy/rhasspy
    container_name: rhasspy
    restart: unless-stopped
    depends_on:
      - mosquitto
    devices:
      - "/dev/snd:/dev/snd"     # ALSA/USB/HAT microphones & speakers
    group_add:
      - "29"                    # 'audio' group on Raspberry Pi OS
    ports:
      - "12101:12101"           # Rhasspy Web UI
    volumes:
      - "./profiles:/profiles"  # your custom profile lives here
    command: >
      --user-profiles /profiles
      --profile en
      --local-mqtt-port 0       # disable internal broker

volumes:
  mosquitto_data:
  mosquitto_log:








